<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Edit Budget</title>
    <link rel="icon" th:src="@{/images/newlogo.svg}" type="image/x-icon">
    <th:block th:insert="~{fragments/generalHeadersFragment.html :: headers}">
    </th:block>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body style="padding-top:70px">
<nav th:replace="~{fragments/navBarFragment :: navBar(activeLink=${activeLink}, extraOffCanvasContent=${null})}"></nav>
<div class="mx-auto container-fluid px-6 py-4" style="max-width: 48rem;">
    <div class="container position-relative">
        <h3 class="m-0 text-center">Edit Budget</h3>
        <form class="renovation-card"
        id="budget-form"
        method="post"
              th:action="@{/renovation/{id}/editBudget(id=${id})}">
            <div class="w-100">
                <div class="row mb-4">
                    <div class="col-12 col-md-6 mb-3 mb-md-0">
                        <label class="form-label expense-category-badge miscellaneous" for="miscellaneousInput">Miscellaneous</label>
                        <span class="form-label">Budget (NZD)</span>
                        <input autocomplete="off" class="form-control" id="miscellaneousInput" name="miscellaneousBudget"
                               placeholder="Enter Miscellaneous Budget" type="text"  th:value="${budget.miscellaneousBudget}" th:classappend="${miscellaneousError} != null ? ' error' : ''">
                        <th:block th:insert="~{fragments/errorMessageFragment.html :: errorMessage(${miscellaneousError})}"/>

                    </div>
                    <div class="col-12 col-md-6">
                        <label class="form-label expense-category-badge material" for="materialInput">Material</label>
                        <span class="form-label">Budget (NZD)</span>
                        <input autocomplete="off" class="form-control" id="materialInput" name="materialBudget"
                               placeholder="Enter Material Budget" type="text" th:value="${budget.materialBudget}" th:classappend="${materialError} != null ? ' error' : ''">
                        <th:block th:insert="~{fragments/errorMessageFragment.html :: errorMessage(${materialError})}"/>

                    </div>
                </div>
                <div class="row mb-4">
                    <div class="col-12 col-md-6 mb-3 mb-md-0">
                        <label class="form-label expense-category-badge labour" for="labourInput">Labour</label>
                        <span class="form-label">Budget (NZD)</span>
                        <input autocomplete="off" class="form-control" id="labourInput" name="labourBudget"
                               placeholder="Enter Labour Budget" type="text" th:value="${budget.labourBudget}" th:classappend="${labourError} != null ? ' error' : ''">
                        <th:block th:insert="~{fragments/errorMessageFragment.html :: errorMessage(${labourError})}"/>

                    </div>
                    <div class="col-12 col-md-6">
                        <label class="form-label expense-category-badge equipment" for="equipmentInput">Equipment</label>
                        <span class="form-label">Budget (NZD)</span>
                        <input autocomplete="off" class="form-control" id="equipmentInput" name="equipmentBudget"
                               placeholder="Enter Equipment Budget" type="text" th:value="${budget.equipmentBudget}" th:classappend="${equipmentError} != null ? ' error' : ''">
                        <th:block th:insert="~{fragments/errorMessageFragment.html :: errorMessage(${equipmentError})}"/>

                    </div>
                </div>
                <div class="row mb-4">
                    <div class="col-12 col-md-6 mb-3 mb-md-0">
                        <label class="form-label expense-category-badge professional-services" for="professionalServicesInput">Professional Services</label>
                        <span class="form-label">Budget (NZD)</span>
                        <input autocomplete="off" class="form-control" id="professionalServicesInput" name="professionalServiceBudget"
                               placeholder="Enter Professional Services Budget" type="text" th:value="${budget.professionalServiceBudget}" th:classappend="${professionalServiceError} != null ? ' error' : ''">
                        <th:block th:insert="~{fragments/errorMessageFragment.html :: errorMessage(${professionalServiceError})}"/>

                    </div>
                    <div class="col-12 col-md-6">
                        <label class="form-label expense-category-badge permit" for="permitInput">Permit</label>
                        <span class="form-label">Budget (NZD)</span>
                        <input autocomplete="off" class="form-control" id="permitInput" name="permitBudget"
                               placeholder="Enter Permit Budget" type="text" th:value="${budget.permitBudget}" th:classappend="${permitError} != null ? ' error' : ''">
                        <th:block th:insert="~{fragments/errorMessageFragment.html :: errorMessage(${permitError})}"/>

                    </div>
                </div>
                <div class="row mb-4">
                    <div class="col-12 col-md-6 mb-3 mb-md-0">
                        <label class="form-label expense-category-badge cleanup" for="cleanupInput">Cleanup</label>
                        <span class="form-label">Budget (NZD)</span>
                        <input autocomplete="off" class="form-control" id="cleanupInput" name="cleanupBudget"
                               placeholder="Enter Cleanup Budget" type="text" th:value="${budget.cleanupBudget}" th:classappend="${cleanupError} != null ? ' error' : ''">
                        <th:block th:insert="~{fragments/errorMessageFragment.html :: errorMessage(${cleanupError})}"/>

                    </div>
                    <div class="col-12 col-md-6">
                        <label class="form-label expense-category-badge delivery" for="deliveryInput">Delivery</label>
                        <span class="form-label">Budget (NZD)</span>
                        <input autocomplete="off" class="form-control" id="deliveryInput" name="deliveryBudget"
                               placeholder="Enter Delivery Budget" type="text" th:value="${budget.deliveryBudget}" th:classappend="${deliveryError} != null ? ' error' : ''">
                        <th:block th:insert="~{fragments/errorMessageFragment.html :: errorMessage(${deliveryError})}"/>

                    </div>
                </div>
                <div class="d-flex flex-column-reverse flex-md-row justify-content-end align-items-md-center gap-2">
                    <a class="button button-secondary"
                       th:href="@{/renovation/{id}/budget(id=${id})}">
                        Cancel
                    </a>
                    <button class="button button-primary submit-button" id="submitButton" type="submit">Submit</button>
                </div>
            </div>
        </form>
    </div>
</div>
<script>
    // With help from ChatGPT for figuring out how to respond to key presses
    document.addEventListener('DOMContentLoaded', () => {
        const allowed = ['Backspace', 'Tab', 'ArrowLeft', 'ArrowRight', 'Delete', 'Home', 'End'];
        const inputs = document.querySelectorAll('input.form-control');

        inputs.forEach(input => {
            input.addEventListener('keydown', (e) => {
                if (allowed.includes(e.key)) { return; }
                if (e.key >= '0' && e.key <= '9') { return; }
                if (e.key === '.' && !input.value.includes('.')) { return; }
                e.preventDefault();
            });
        });
    });
</script>
</body>
</html>