<!--/*@thymesVar id="renovation" type="nz.ac.canterbury.seng302.homehelper.entity.renovation.Renovation"*/-->
<th:block th:fragment="renovationSidebarContent(renoChannels)">
    <div class="sidebar-group">
        <div class="sidebar-group-label" th:text="${renovation.name}"></div>

        <div class="sidebar-group-content">
            <ul class="sidebar-menu">
                <li class="sidebar-menu-item">
                    <a class="sidebar-menu-button"
                       th:classappend="${contentType == 'overview' ? 'active' : ''}"
                       th:href="@{/renovation/{id}(id=${renovation.id})}">
                        Overview
                    </a>
                </li>
                <li class="sidebar-menu-item">
                    <a class="sidebar-menu-button"
                       th:classappend="${contentType == 'members' ? 'active' : ''}"
                       th:href="@{/renovation/{id}/members(id=${renovation.id})}">
                        Members
                    </a>
                </li>
                <li class="sidebar-menu-item">
                    <a class="sidebar-menu-button"
                       th:classappend="${(contentType == 'tasks' or contentType == 'task') ? 'active' : ''}"
                       th:href="@{/renovation/{id}/tasks(id=${renovation.id})}">
                        Tasks
                    </a>
                </li>
                <li class="sidebar-menu-item">
                    <a class="sidebar-menu-button"
                       th:classappend="${contentType == 'calendar' ? 'active' : ''}"
                       th:href="@{/renovation/{id}/calendar(id=${renovation.id})}">
                        Calendar
                    </a>
                </li>
                <li th:if="${isMember}" class="sidebar-menu-item">
                    <a class="sidebar-menu-button"
                       th:classappend="${contentType == 'budget' ? 'active' : ''}"
                       th:href="@{/renovation/{id}/budget(id=${renovation.id})}">
                        Budget
                    </a>
                </li>
                <li th:if="${isMember}" class="sidebar-menu-item">
                    <a class="sidebar-menu-button"
                       th:classappend="${contentType == 'expenses' ? 'active' : ''}"
                       th:href="@{/renovation/{id}/expenses(id=${renovation.id})}">
                        Expenses
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <div class="sidebar-separator"></div>

    <div class="sidebar-group">
        <div class="sidebar-group-header">
            <div class="sidebar-group-label">
                <div class="d-flex justify-content-between align-items-center">
                    <span>Team Members</span>

                    <a th:if="${isOwner}" class="invite-member-button" data-bs-toggle="modal"
                       th:data-bs-target="'#inviteModal' + ${renovation.id}" type="button">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                             class="lucide lucide-user-plus-icon lucide-user-plus">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                            <circle cx="9" cy="7" r="4"/>
                            <line x1="19" x2="19" y1="8" y2="14"/>
                            <line x1="22" x2="16" y1="11" y2="11"/>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
        <div class="sidebar-group-content">
            <div th:each="member, iterStat : ${renovation.sortedMembers}"
                 th:if="${iterStat.index < 2}"
                 class="team-members">
                <div class="team-member">
                    <img th:if="${member.user.image != null}"
                         th:src="@{${'/'} + ${member.user.image}}"
                         class="rounded-circle" height="32" width="32" style="border-radius: 50%" alt="User Image"/>
                    <img th:if="${member.user.image == null}"
                         th:src="@{/images/PlaceholderIcon.png}"
                         class="rounded-circle" height="32" width="32" style="border-radius: 50%" alt="User Image"/>
                    <div class="team-member-info">
                        <div class="team-member-name" th:text="|${member.user.fname} ${member.user.lname}|"></div>
                        <div class="team-member-role" th:text="${member.role.displayName}"></div>
                    </div>
                </div>
            </div>

            <!-- Show "View All" button if there are more than 2 members -->
            <div th:if="${#lists.size(renovation.getSortedMembers()) > 2}" class="d-flex justify-content-center">
                <a th:href="@{/renovation/{id}/members(id=${renovation.id})}"
                   class="button button-transparent-primary pb-0" style="font-size: 0.75rem">View All Members</a>
            </div>
        </div>
    </div>

    <th:block th:if="${isMember}">
        <div class="sidebar-separator"></div>

        <div class="sidebar-group">
            <div class="sidebar-group-header">
                <div class="sidebar-group-label">
                    <div class="d-flex justify-content-between align-items-center">
                        <span>Chat Channels</span>

                        <a th:if="${isOwner}" class="invite-member-button" data-bs-toggle="modal"
                           th:data-bs-target="'#newChannelModal'" type="button">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"
                                 fill="none"
                                 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                 class="lucide lucide-plus-icon lucide-plus">
                                <path d="M5 12h14"/>
                                <path d="M12 5v14"/>
                            </svg>
                        </a>
                    </div>
                </div>
            </div>
            <div class="sidebar-group-content">
                <ul class="sidebar-menu">
                    <li th:each="renoChannel : ${renoChannels}" class="sidebar-menu-item">
                        <a th:href="@{/renovation/{id}/chat/{channelId}(id=${renovation.id}, channelId=${renoChannel.id})}"
                           class="text-decoration-none text-reset">
                            <button class="chat-channel"
                                    th:classappend="${channel != null and channel.id == renoChannel.id ? 'active' : ''}"
                                    th:with="isAiChannel=${renoChannel.name == 'brickAI'}">
                                <div class="chat-channel-content">
                                    <!-- hashtag if it's a normal channel -->
                                    <!-- https://lucide.dev/icons/hash -->
                                    <svg th:unless="${isAiChannel}" xmlns="http://www.w3.org/2000/svg"
                                         viewBox="0 0 24 24"
                                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                         stroke-linejoin="round" class="chat-channel-icon">
                                        <line x1="4" x2="20" y1="9" y2="9"/>
                                        <line x1="4" x2="20" y1="15" y2="15"/>
                                        <line x1="10" x2="8" y1="3" y2="21"/>
                                        <line x1="16" x2="14" y1="3" y2="21"/>
                                    </svg>

                                    <!-- bot icon if its ai channel -->
                                    <!-- https://lucide.dev/icons/bot-message-square -->
                                    <svg th:if="${isAiChannel}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                         stroke-linejoin="round"
                                         class="chat-channel-icon">
                                        <path d="M12 6V2H8"/>
                                        <path d="M15 11v2"/>
                                        <path d="M2 12h2"/>
                                        <path d="M20 12h2"/>
                                        <path d="M20 16a2 2 0 0 1-2 2H8.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 4 20.286V8a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2z"/>
                                        <path d="M9 11v2"/>
                                    </svg>

                                    <span th:text="${renoChannel.name}" class="chat-channel-name"></span>
                                    <div th:if="${renoChannel.name == 'brickAI'}">
                                        <span class="badge bg-secondary ai-badge"
                                              style="font-size: 0.625rem !important;">BOT</span>
                                    </div>
                                </div>
                            </button>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </th:block>
</th:block>
