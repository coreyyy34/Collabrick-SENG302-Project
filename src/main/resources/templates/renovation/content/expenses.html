<th:block th:fragment="head">

</th:block>
<div th:fragment="content">
    <div th:replace="~{fragments/renovation/renovationTitleFragment :: renovationTitle(${renovation.name}, false)}"></div>
    <!-- Header -->
    <div class="renovation-card mt-4 mb-4">
        <div class="renovation-content">
            <div style="padding-top: 10px">
                <p class="renovation-description">
                    <b>Current total expenditure:</b>
                    <span class="expense-highlight" id="expenseTotal" th:text="${expenseTotal == 0} ? '$0.00' : '$' + ${expenseTotal}"></span>
                    NZD across
                    <span class="expense-highlight" id="expenseItems" th:text="${expenses.size()}"></span>
                    expense items.
                </p>
            </div>
        </div>
    </div>

    <!-- Table display on desktop -->
    <div class="d-none d-lg-block table-responsive">
        <table class="table mb-4" style="table-layout: fixed; width: 100%;" th:if="${expenses.size()} > 0">
            <thead>
            <tr>
                <th style="cursor: pointer; width: 40%;">Name</th>
                <th style="cursor: pointer; width: 16%;">Date</th>
                <th style="cursor: pointer; width: 18%;">Price</th>
                <th style="cursor: pointer; width: 28%;">Category</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="expense : ${expenses}" th:id="'expense-' + ${expense.id}">
                <td class="py-3" style="word-wrap: break-word;">
                        <span th:text="${expense.expenseName}">
                        </span>
                </td>
                <td class="py-3">
                        <span class="badge bg-secondary"
                              th:if="${expense.getExpenseDate() != null}"
                              th:text="${T(nz.ac.canterbury.seng302.homehelper.utility.UserUtil).formatDate(expense.getExpenseDate())}">
                        </span>
                </td>
                <td class="py-3">
                        <span class="expense-highlight"  th:text="'$' + ${expense.expenseCost}">
                        </span>
                </td>
                <td class="py-3">
                        <span class="expense-category-badge" style="white-space: nowrap;"
                              th:classappend="${expense.expenseCategory.replaceAll(' ', '-').toLowerCase()}"
                              th:text="${expense.expenseCategory}">
                        </span>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

    <!-- Table display on mobile -->
    <!-- ChatGPT helped figure out how to display a different view for smaller screens
         See also: https://getbootstrap.com/docs/5.0/layout/breakpoints/ -->
    <div class="d-block d-lg-none" th:if="${expenses.size()} > 0">
        <div th:each="expense : ${expenses}" class="card mb-3 position-relative">
            <div class="card-body">

                <!-- Name & Price -->
                <div class="d-flex justify-content-between align-items-start mb-2">
                    <div class="text-break">
                        <span class="mb-1 task-title" th:text="${expense.expenseName}">Task Name</span>
                    </div>
                    <div class="d-flex align-items-center gap-1 flex-wrap ms-3">
                        <span class="expense-highlight" th:text="'$' + ${expense.expenseCost}"></span>
                    </div>
                </div>

                <!-- Date & Category -->
                <div class="d-flex gap-2 flex-wrap">
                        <span class="badge bg-secondary"
                              th:if="${expense.getExpenseDate() != null}"
                              th:text="'Due ' + ${T(nz.ac.canterbury.seng302.homehelper.utility.UserUtil).formatDate(expense.getExpenseDate())}"></span>
                    <span class="badge"
                          th:classappend="${expense.expenseCategory.replaceAll(' ', '-').toLowerCase()}"
                          th:text="${expense.expenseCategory}"></span>
                </div>

            </div>
        </div>
    </div>

    <!-- Display if the Renovation has no Expenses -->
    <div class="renovation-card mt-4" th:if="${expenses.size()} == 0">
        <div class="renovation-content">
            There is no recorded expenditure for this renovation. Add expenses to your renovation's tasks to have them show up here.
        </div>
    </div>
</div>
<th:block th:fragment="scripts">
    <script th:src="@{/javascript/renovationExpenditures.js}"></script>
</th:block>